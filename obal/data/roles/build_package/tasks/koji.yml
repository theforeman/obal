---
- name: 'Use tito to build package'
  when: not build_package_use_koji_build | bool
  block:
    - name: Scratch build with koji_build
      when:
        - build_package_scratch
        - koji_tags is truthy
      include_tasks: koji_build.yml
      loop: "{{ koji_tags }}"
      loop_control:
        loop_var: tag

    - name: Release with tito
      when: (build_package_scratch and koji_tags is not truthy) or (not build_package_scratch)
      include_tasks: tito_release.yml

- when: build_package_use_koji_build | bool
  block:
    - include_tasks: koji_build.yml
      loop: "{{ koji_tags }}"
      loop_control:
        loop_var: tag
